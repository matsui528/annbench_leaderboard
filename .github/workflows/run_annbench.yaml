name: run-ann-bench

on: pull_request

jobs:
  run:    
    runs-on: ubuntu-latest
    container: docker://dvcorg/cml-py3:latest
    steps:
      # Clone this repository
      - name: Checkout this repository
        uses: actions/checkout@v2

      # Clone annbench on ./annbench
      - name: Checkout annbench
        uses: actions/checkout@v2
        with:
          repository: matsui528/annbench
          path: annbench

      # Run the benchmark
      # Note that `cml-send-comment` must be run on the original position (the root of this repo)
      - name: Run annbench
        env:
          repo_token: ${{ secrets.GITHUB_TOKEN }}
        run: |
          which python 
          python --version
          pip --version

          # ls
          # cd annbench
          # ls
          # ls >> ../report.md
          # cd ..
          # cml-send-comment report.md

          cd annbench
          ls >> report.md
          cd ..
          cml-send-comment ./annbench/report.md



          # cd annbench
          # pip install -r requirements.txt
          # python download.py dataset=siftsmall
          # python run.py dataset=siftsmall algo=annoy num_trial=1
          # python plot.py

          
